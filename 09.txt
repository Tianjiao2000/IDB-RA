(<P> [Name] (Artists)) <D> (<R> [Artist -> Name] (<P> [Artist] (<P> [Artist, Year, y1] (<S> [Artist = a1 & Year < y1 & Type='STUDIO' & ty1='STUDIO'] (Albums <X> (<R> [Title -> t1, Artist -> a1, Year -> y1, Type -> ty1, Rating -> r1] (Albums)))) <D> (<R> [y -> Year] (<P> [Artist, y, y1] (<S> [Artist = a & y < Year & Year < y1] (Albums <X> (<R> [Title -> t, Artist -> a, Year -> y, Type -> ty, Rating -> r] (<S> [Artist = a1 & Year < y1 & Type='STUDIO' & ty1='STUDIO'] (Albums <X> (<R> [Title -> t1, Artist -> a1, Year -> y1, Type -> ty1, Rating -> r1] (Albums))))))))))))